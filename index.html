<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üíó Quiz C≈ìur ‚Äî Saint-Valentin üíó</title>
  <style>
    /* ===== FONTS ===== */
    @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Quicksand:wght@400;500;600;700&display=swap');

    /* ===== VARIABLES ===== */
    :root {
      --rose-pale:    #FFD6E7;
      --rose-moyen:   #FF9DBD;
      --rose-vif:     #FF6B9D;
      --rouge-doux:   #FF4F7B;
      --lavande:      #F3C5E6;
      --blanc:        #FFFAFA;
      --blanc-creme:  #FFF0F5;
      --gris-doux:    #888;
      --or:           #FFD700;
      --vert-ok:      #A8E6CF;
      --rouge-err:    #FFB3BA;
      --shadow:       0 8px 32px rgba(255,107,157,0.18);
      --radius:       22px;
      --transition:   0.4s cubic-bezier(.34,1.56,.64,1);
    }

    /* ===== RESET & BASE ===== */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Nunito', sans-serif;
      background: #fff0f7;
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
    }

    /* ===== FOND ECG ===== */
    .ecg-bg {
      position: fixed;
      bottom: 0; left: 0;
      width: 100%; height: 80px;
      pointer-events: none;
      z-index: 0;
      opacity: 0.18;
    }
    .ecg-line {
      stroke: var(--rose-vif);
      stroke-width: 2.5;
      fill: none;
      stroke-dasharray: 1000;
      stroke-dashoffset: 1000;
      animation: ecgDraw 4s linear infinite;
    }
    @keyframes ecgDraw {
      0%   { stroke-dashoffset: 1000; }
      100% { stroke-dashoffset: 0; }
    }

    /* ===== PETITS C≈íURS FLOTTANTS ===== */
    .floating-hearts {
      position: fixed; inset: 0;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }
    .fheart {
      position: absolute;
      font-size: 1.2rem;
      animation: floatHeart linear infinite;
      opacity: 0;
    }
    @keyframes floatHeart {
      0%   { transform: translateY(100vh) rotate(0deg); opacity: 0.7; }
      100% { transform: translateY(-10vh) rotate(20deg); opacity: 0; }
    }

    /* ===== CONTAINER PRINCIPAL ===== */
    .container {
      position: relative; z-index: 2;
      max-width: 700px;
      margin: 0 auto;
      padding: 30px 18px 60px;
    }

    /* ===== HEADER ===== */
    header {
      text-align: center;
      margin-bottom: 28px;
      animation: slideDown .7s var(--transition) both;
    }
    @keyframes slideDown {
      from { opacity:0; transform: translateY(-30px); }
      to   { opacity:1; transform: translateY(0); }
    }
    header .emoji-top { font-size: 2.6rem; margin-bottom: 6px; display: block; animation: beat 1.4s ease-in-out infinite; }
    @keyframes beat {
      0%,100%{ transform:scale(1); }
      50%    { transform:scale(1.18); }
    }
    header h1 {
      font-size: clamp(1.4rem, 4vw, 2rem);
      font-weight: 900;
      background: linear-gradient(135deg, var(--rouge-doux), var(--rose-vif), #ff9dbdcc);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: 0.5px;
      margin-bottom: 6px;
    }
    header p {
      color: #c46890;
      font-size: .95rem;
      font-family: 'Quicksand', sans-serif;
      font-weight: 600;
    }

    /* ===== PUZZLE ZONE ===== */
    .puzzle-zone {
      background: var(--blanc-creme);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 20px;
      margin-bottom: 28px;
      text-align: center;
      border: 2px solid var(--rose-pale);
    }
    .puzzle-label {
      font-size: .8rem;
      color: var(--rose-vif);
      font-weight: 700;
      letter-spacing: 1px;
      text-transform: uppercase;
      margin-bottom: 12px;
    }
    .puzzle-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      width: 200px;
      height: 200px;
      margin: 0 auto;
      position: relative;
    }
    .puzzle-piece {
      border-radius: 10px;
      background: var(--rose-pale);
      border: 2.5px dashed var(--rose-moyen);
      display: flex; align-items: center; justify-content: center;
      font-size: 2rem;
      transition: all 0.5s var(--transition);
      position: relative;
      overflow: hidden;
    }
    .puzzle-piece.filled {
      background: linear-gradient(135deg, var(--rose-vif), var(--rouge-doux));
      border: 2.5px solid var(--rouge-doux);
      animation: pieceIn 0.6s var(--transition) both;
      box-shadow: 0 4px 16px rgba(255,79,123,.25);
    }
    @keyframes pieceIn {
      0%  { transform: scale(0) rotate(-15deg); opacity: 0; }
      60% { transform: scale(1.15) rotate(3deg); }
      100%{ transform: scale(1) rotate(0deg); opacity: 1; }
    }
    .puzzle-piece.filled::after {
      content: '';
      position: absolute; inset: 0;
      background: linear-gradient(135deg, rgba(255,255,255,.35), transparent);
      border-radius: 8px;
    }
    .piece-icon { position: relative; z-index: 1; font-size: 1.6rem; filter: drop-shadow(0 2px 4px rgba(0,0,0,.15)); }

    /* Progression bar */
    .progress-bar-wrap {
      margin-top: 14px;
      background: var(--rose-pale);
      border-radius: 99px;
      height: 10px;
      overflow: hidden;
    }
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--rose-vif), var(--rouge-doux));
      border-radius: 99px;
      width: 0%;
      transition: width 0.6s ease;
    }
    .progress-text {
      font-size: .78rem;
      color: #c46890;
      margin-top: 6px;
      font-weight: 700;
    }

    /* ===== CARD QUESTION ===== */
    .card {
      background: var(--blanc);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 28px 24px 22px;
      border: 2px solid var(--rose-pale);
      animation: cardIn .5s var(--transition) both;
    }
    @keyframes cardIn {
      from { opacity:0; transform: translateY(25px) scale(.97); }
      to   { opacity:1; transform: translateY(0) scale(1); }
    }

    .question-badge {
      display: inline-block;
      background: linear-gradient(135deg, var(--rose-vif), var(--rouge-doux));
      color: white;
      font-size: .75rem;
      font-weight: 800;
      padding: 4px 12px;
      border-radius: 99px;
      margin-bottom: 12px;
      letter-spacing: .5px;
    }
    .question-text {
      font-size: 1.05rem;
      font-weight: 700;
      color: #5a3040;
      line-height: 1.55;
      margin-bottom: 20px;
    }

    /* ===== OPTIONS ===== */
    .options { display: flex; flex-direction: column; gap: 11px; }

    .option-btn {
      background: var(--blanc-creme);
      border: 2px solid var(--rose-pale);
      border-radius: 14px;
      padding: 13px 18px;
      text-align: left;
      font-family: 'Nunito', sans-serif;
      font-size: .93rem;
      font-weight: 600;
      color: #7a4060;
      cursor: pointer;
      transition: all .25s ease;
      position: relative;
      overflow: hidden;
      display: flex; align-items: center; gap: 10px;
    }
    .option-btn::before {
      content: '';
      position: absolute; inset: 0;
      background: linear-gradient(135deg, rgba(255,107,157,.08), transparent);
      opacity: 0;
      transition: opacity .2s;
    }
    .option-btn:hover:not(:disabled)::before { opacity: 1; }
    .option-btn:hover:not(:disabled) {
      border-color: var(--rose-vif);
      transform: translateX(4px);
      box-shadow: 0 4px 14px rgba(255,107,157,.15);
    }
    .option-letter {
      min-width: 28px; height: 28px;
      border-radius: 50%;
      background: var(--rose-pale);
      color: var(--rouge-doux);
      font-weight: 800;
      font-size: .8rem;
      display: flex; align-items: center; justify-content: center;
      transition: all .25s;
      flex-shrink: 0;
    }
    .option-btn:hover:not(:disabled) .option-letter {
      background: var(--rose-vif);
      color: white;
    }

    /* √âtats r√©ponse */
    .option-btn.correct {
      background: linear-gradient(135deg, #d4f5e2, #c0f0d5);
      border-color: #4caf82;
      color: #2a6644;
      transform: translateX(0) scale(1.01);
      animation: correctPop .4s var(--transition);
    }
    @keyframes correctPop {
      0%  { transform: scale(.97); }
      60% { transform: scale(1.03); }
      100%{ transform: scale(1.01); }
    }
    .option-btn.correct .option-letter { background: #4caf82; color: white; }

    .option-btn.wrong {
      background: linear-gradient(135deg, #ffe0e8, #ffd0d8);
      border-color: #e07090;
      color: #8b3050;
      animation: shake .45s ease;
    }
    @keyframes shake {
      0%,100%{ transform: translateX(0); }
      20%    { transform: translateX(-7px); }
      40%    { transform: translateX(7px); }
      60%    { transform: translateX(-4px); }
      80%    { transform: translateX(4px); }
    }
    .option-btn.wrong .option-letter { background: #e07090; color: white; }
    .option-btn:disabled { cursor: not-allowed; }

    /* ===== FEEDBACK ===== */
    .feedback {
      margin-top: 18px;
      padding: 14px 18px;
      border-radius: 14px;
      font-weight: 700;
      font-size: .92rem;
      display: flex; align-items: center; gap: 10px;
      animation: feedIn .4s var(--transition) both;
      display: none;
    }
    @keyframes feedIn {
      from { opacity:0; transform:translateY(8px); }
      to   { opacity:1; transform:translateY(0); }
    }
    .feedback.good {
      background: linear-gradient(135deg, #d4f5e2, #c0edd5);
      color: #2a6644;
      border: 1.5px solid #80d4a0;
    }
    .feedback.bad {
      background: linear-gradient(135deg, #ffe0e8, #ffd0d8);
      color: #8b3050;
      border: 1.5px solid #e09090;
    }
    .feedback-sticker { font-size: 1.5rem; }

    /* ===== BTN NEXT ===== */
    .btn-next {
      margin-top: 16px;
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, var(--rose-vif), var(--rouge-doux));
      color: white;
      border: none;
      border-radius: 14px;
      font-family: 'Nunito', sans-serif;
      font-size: 1rem;
      font-weight: 800;
      cursor: pointer;
      transition: all .25s ease;
      letter-spacing: .3px;
      display: none;
      box-shadow: 0 4px 16px rgba(255,79,123,.3);
    }
    .btn-next:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(255,79,123,.4); }
    .btn-next:active { transform: translateY(0); }

    /* ===== PLUIE DE C≈íURS ===== */
    .heart-rain { position: fixed; inset: 0; pointer-events: none; z-index: 100; }
    .rain-heart {
      position: absolute;
      font-size: 1.4rem;
      animation: rainFall .9s ease-out forwards;
      top: -30px;
    }
    @keyframes rainFall {
      to { transform: translateY(110vh) rotate(360deg); opacity: 0; }
    }

    /* ===== √âCRAN FINAL PUZZLE COMPLET ===== */
    #screen-complete {
      display: none;
      text-align: center;
      animation: cardIn .6s var(--transition) both;
    }
    .complete-title {
      font-size: 1.5rem;
      font-weight: 900;
      background: linear-gradient(135deg, var(--rouge-doux), var(--rose-vif));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 12px;
    }
    .heart-final {
      font-size: 5rem;
      display: block;
      animation: heartBeat 1.2s ease-in-out infinite;
      margin: 10px auto 18px;
      filter: drop-shadow(0 0 18px rgba(255,79,123,.5));
    }
    @keyframes heartBeat {
      0%,100%{ transform:scale(1); }
      14%    { transform:scale(1.3); }
      28%    { transform:scale(1.1); }
      42%    { transform:scale(1.25); }
    }

    /* Puzzle image compl√®te */
    .puzzle-complete-img {
      width: 300px; height: 200px;
      border-radius: var(--radius);
      object-fit: cover;
      border: 4px solid var(--rose-vif);
      box-shadow: 0 0 30px rgba(255,79,123,.35);
      margin: 0 auto 20px;
      display: block;
      animation: glowIn .8s var(--transition) both;
    }
    @keyframes glowIn {
      from { opacity:0; transform:scale(.7); filter:brightness(2); }
      to   { opacity:1; transform:scale(1); filter:brightness(1); }
    }

    /* Puzzle SVG assembl√© (si pas d'image externe) */
    .puzzle-assembled {
      width: 200px; height: 200px;
      margin: 0 auto 20px;
      border-radius: var(--radius);
      background: linear-gradient(135deg, var(--rose-vif), var(--rouge-doux));
      display: flex; align-items: center; justify-content: center;
      font-size: 4.5rem;
      animation: glowIn .8s var(--transition) both;
      box-shadow: 0 0 30px rgba(255,79,123,.4);
      position: relative;
      overflow: hidden;
    }
    .puzzle-assembled::before {
      content: '';
      position: absolute; inset: 0;
      background: radial-gradient(ellipse at 30% 30%, rgba(255,255,255,.4), transparent 60%);
    }

    /* ===== ENVELOPPE ===== */
    #screen-envelope {
      display: none;
      text-align: center;
    }
    .envelope-wrap {
      perspective: 600px;
    }
    .envelope {
      width: 220px; height: 150px;
      background: linear-gradient(145deg, #ffb3d0, #ff85b0);
      border-radius: 12px 12px 8px 8px;
      margin: 0 auto 20px;
      position: relative;
      cursor: pointer;
      transition: transform .3s ease;
      animation: envShake 2.5s ease-in-out infinite;
      box-shadow: 0 10px 30px rgba(255,79,123,.3);
    }
    @keyframes envShake {
      0%,100%{ transform: rotate(0deg) scale(1); }
      25%    { transform: rotate(-2deg) scale(1.02); }
      75%    { transform: rotate(2deg) scale(1.02); }
    }
    .envelope:hover { animation: none; transform: scale(1.06) rotate(-1deg); }

    /* Rabat haut de l'enveloppe */
    .env-flap {
      position: absolute; top: 0; left: 0; right: 0;
      height: 0;
      border-left: 110px solid transparent;
      border-right: 110px solid transparent;
      border-top: 70px solid #ff6b9d;
      border-radius: 12px 12px 0 0;
      transform-origin: top center;
      transition: transform .6s ease;
      z-index: 2;
    }
    .envelope.opening .env-flap {
      transform: rotateX(180deg);
    }
    /* C≈ìur sur l'enveloppe */
    .env-heart {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      font-size: 2.4rem;
      z-index: 3;
      animation: envHeartBeat 1s ease-in-out infinite;
      filter: drop-shadow(0 2px 6px rgba(0,0,0,.2));
    }
    @keyframes envHeartBeat {
      0%,100%{ transform:translate(-50%,-50%) scale(1); }
      50%    { transform:translate(-50%,-50%) scale(1.2); }
    }
    /* Lignes de l'enveloppe */
    .env-lines {
      position: absolute; bottom: 0; left: 0; right: 0; top: 0;
      border-radius: 12px;
      overflow: hidden;
    }
    .env-lines::before {
      content: '';
      position: absolute;
      bottom: 0; left: 0;
      border-bottom: 75px solid #ff9dbdaa;
      border-right: 110px solid transparent;
    }
    .env-lines::after {
      content: '';
      position: absolute;
      bottom: 0; right: 0;
      border-bottom: 75px solid #ff9dbd99;
      border-left: 110px solid transparent;
    }

    .envelope-hint {
      color: #c46890;
      font-size: .88rem;
      font-weight: 700;
      margin-bottom: 14px;
      animation: pulse 1.5s ease infinite;
    }
    @keyframes pulse { 0%,100%{opacity:1;} 50%{opacity:.5;} }

    /* ===== MESSAGE D'AMOUR ===== */
    #screen-message {
      display: none;
      animation: cardIn .7s var(--transition) both;
    }
    .letter-card {
      background: linear-gradient(135deg, #fff5f9, #ffe0ee);
      border-radius: var(--radius);
      padding: 32px 26px;
      border: 2px solid var(--rose-pale);
      box-shadow: 0 12px 40px rgba(255,107,157,.2);
      position: relative;
      overflow: hidden;
    }
    .letter-card::before {
      content: 'üíå';
      position: absolute; top: -10px; right: -10px;
      font-size: 5rem;
      opacity: .07;
      transform: rotate(15deg);
    }
    .letter-date {
      font-size: .78rem;
      color: var(--rose-vif);
      font-weight: 700;
      text-align: right;
      margin-bottom: 10px;
      font-family: 'Quicksand', sans-serif;
    }
    .letter-text {
      font-size: 1.05rem;
      line-height: 1.8;
      color: #7a3055;
      font-family: 'Quicksand', sans-serif;
      font-weight: 600;
      text-align: center;
    }
    .letter-text em {
      font-style: italic;
      color: var(--rouge-doux);
    }
    .letter-signature {
      margin-top: 18px;
      text-align: right;
      color: var(--rose-vif);
      font-weight: 800;
      font-size: 1rem;
    }

    /* Audio controls */
    .audio-controls {
      margin-top: 18px;
      display: flex; justify-content: center; gap: 12px; flex-wrap: wrap;
    }
    .btn-audio {
      padding: 10px 22px;
      background: linear-gradient(135deg, var(--rose-vif), var(--rouge-doux));
      color: white;
      border: none;
      border-radius: 99px;
      font-family: 'Nunito', sans-serif;
      font-size: .88rem;
      font-weight: 800;
      cursor: pointer;
      transition: all .25s;
      box-shadow: 0 4px 14px rgba(255,79,123,.3);
    }
    .btn-audio:hover { transform: translateY(-2px); box-shadow: 0 6px 18px rgba(255,79,123,.4); }

    /* ===== LUMI√àRE FINALE ===== */
    .final-glow {
      position: fixed; inset: 0;
      background: radial-gradient(ellipse at center, rgba(255,200,220,.5) 0%, transparent 70%);
      pointer-events: none;
      z-index: 50;
      display: none;
      animation: glowFade 2s ease forwards;
    }
    @keyframes glowFade { 0%{opacity:0;} 30%{opacity:1;} 100%{opacity:0;} }

    /* ===== OVERLAY FLASH ===== */
    .flash-overlay {
      position: fixed; inset: 0;
      background: rgba(255,255,255,.8);
      pointer-events: none; z-index: 200;
      display: none;
      animation: flashFade .4s ease forwards;
    }
    @keyframes flashFade { 0%{opacity:1;} 100%{opacity:0;} }

    /* ===== PROGRESS DOTS ===== */
    .progress-dots {
      display: flex; gap: 8px; justify-content: center;
      margin-bottom: 14px;
    }
    .dot {
      width: 10px; height: 10px;
      border-radius: 50%;
      background: var(--rose-pale);
      border: 2px solid var(--rose-moyen);
      transition: all .3s ease;
    }
    .dot.active { background: var(--rose-vif); border-color: var(--rouge-doux); transform: scale(1.3); }
    .dot.done   { background: var(--rouge-doux); border-color: var(--rouge-doux); }

    /* ===== RESPONSIVE ===== */
    @media(max-width: 480px) {
      .container { padding: 20px 12px 50px; }
      .card { padding: 20px 16px; }
      .puzzle-grid { width: 170px; height: 170px; }
    }
  </style>
</head>
<body>

<!-- ECG de fond -->
<svg class="ecg-bg" viewBox="0 0 1440 80" preserveAspectRatio="none">
  <path class="ecg-line" d="M0,40 L80,40 L90,40 L95,10 L100,60 L110,5 L120,55 L130,40 L240,40 L250,40 L255,10 L260,60 L270,5 L280,55 L290,40 L400,40 L410,40 L415,10 L420,60 L430,5 L440,55 L450,40 L560,40 L570,40 L575,10 L580,60 L590,5 L600,55 L610,40 L720,40 L730,40 L735,10 L740,60 L750,5 L760,55 L770,40 L880,40 L890,40 L895,10 L900,60 L910,5 L920,55 L930,40 L1040,40 L1050,40 L1055,10 L1060,60 L1070,5 L1080,55 L1090,40 L1200,40 L1210,40 L1215,10 L1220,60 L1230,5 L1240,55 L1250,40 L1440,40"/>
</svg>

<!-- C≈ìurs flottants -->
<div class="floating-hearts" id="floatingHearts"></div>

<!-- Flash overlay -->
<div class="flash-overlay" id="flashOverlay"></div>

<!-- Lueur finale -->
<div class="final-glow" id="finalGlow"></div>

<!-- Pluie de c≈ìurs -->
<div class="heart-rain" id="heartRain"></div>

<!-- CONTENU PRINCIPAL -->
<div class="container">

  <!-- Header -->
  <header>
    <span class="emoji-top">üíó</span>
    <h1>Quiz C≈ìur ‚Äî Saint-Valentin</h1>
    <p>Anatomie macroscopique ‚Ä¢ 3√®me ann√©e m√©decine</p>
  </header>

  <!-- Zone Puzzle -->
  <div class="puzzle-zone">
    <div class="puzzle-label">üß© Assemble ton c≈ìur !</div>
    <div class="puzzle-grid" id="puzzleGrid">
      <div class="puzzle-piece" id="piece-0"><span>ü§ç</span></div>
      <div class="puzzle-piece" id="piece-1"><span>ü§ç</span></div>
      <div class="puzzle-piece" id="piece-2"><span>ü§ç</span></div>
      <div class="puzzle-piece" id="piece-3"><span>ü§ç</span></div>
    </div>
    <div class="progress-bar-wrap">
      <div class="progress-bar" id="progressBar"></div>
    </div>
    <div class="progress-text" id="progressText">0 / 4 pi√®ces collect√©es</div>
  </div>

  <!-- Dots de progression -->
  <div class="progress-dots" id="progressDots">
    <div class="dot active" id="dot-0"></div>
    <div class="dot" id="dot-1"></div>
    <div class="dot" id="dot-2"></div>
    <div class="dot" id="dot-3"></div>
  </div>

  <!-- √âcran Quiz -->
  <div id="screen-quiz">
    <div class="card" id="quizCard">
      <span class="question-badge" id="questionBadge">Question 1 / 4</span>
      <p class="question-text" id="questionText"></p>
      <div class="options" id="optionsContainer"></div>
      <div class="feedback" id="feedback">
        <span class="feedback-sticker" id="feedbackSticker"></span>
        <span id="feedbackMsg"></span>
      </div>
      <button class="btn-next" id="btnNext" onclick="nextQuestion()">Question suivante üíó</button>
    </div>
  </div>

  <!-- √âcran : Puzzle complet -->
  <div id="screen-complete">
    <div class="card">
      <h2 class="complete-title">üéâ F√©licitations, Dr. Lili ! üéâ</h2>
      <span class="heart-final">üíù</span>
      <img src="puzzl_finale.jpg" class="puzzle-complete-img" alt="Puzzle complet">

      <p style="color:#c46890; font-weight:700; font-size:.95rem; margin-bottom:16px;">
        Tu as assembl√© le c≈ìur en entier !<br>
        <small style="font-weight:600; opacity:.8">Maintenant‚Ä¶ une surprise t'attend üíå</small>
      </p>
      <button class="btn-next" style="display:block;" onclick="showEnvelope()">Voir ma surprise ‚ú®</button>
    </div>
  </div>

  <!-- √âcran : Enveloppe -->
  <div id="screen-envelope">
    <div class="card">
      <h2 style="color:#c46890; font-weight:900; font-size:1.3rem; margin-bottom:6px;">Une lettre pour toi‚Ä¶ üíå</h2>
      <p class="envelope-hint">Clique sur l'enveloppe pour l'ouvrir</p>
      <div class="envelope-wrap">
        <div class="envelope" id="envelope" onclick="openEnvelope()">
          <div class="env-lines"></div>
          <div class="env-flap" id="envFlap"></div>
          <div class="env-heart" id="envHeart">üíó</div>
        </div>
      </div>
    </div>
  </div>

  <!-- √âcran : Message d'amour -->
  <div id="screen-message">
    <div class="letter-card">
      <div class="letter-date">14 F√©vrier 2026 üíå</div>
      <div class="letter-text">
        <p>Ch√®re <em>Lili</em>,</p>
        <br>
        <p>Merci d'√™tre mon amie,<br>
        m√™me si nos chemins se sont s√©par√©s,<br>
        j'esp√®re que tu souriras aujourd'hui<br>
        en voyant ce que j'ai cr√©√© pour toi üå∏</p>
        <br>
        <p style="font-size:1.2rem;">hihi ü©∑</p>
      </div>
      <div class="letter-signature">Avec tout mon amour üíó</div>
      <div class="audio-controls">
        <button class="btn-audio" onclick="playAudio()">‚ñ∂ Rejouer la musique üéµ</button>
      </div>
    </div>
  </div>

</div><!-- /container -->

<!-- Audio -->
<audio id="audioMessage" preload="auto">
  <source src="lili2.mp3" type="audio/mpeg">
</audio>
<audio id="bgMusic" loop preload="auto">
  <source src="bg_song.mp3" type="audio/mpeg">
</audio>

<script>
/* ============================================================
   DONN√âES ‚Äî 4 QUESTIONS D'ANATOMIE MACROSCOPIQUE DU C≈íUR
   Niveau 3√®me ann√©e m√©decine
   ============================================================ */
const questions = [
  {
    text: "Concernant l'orientation du c≈ìur dans le thorax, quelle affirmation est correcte ?",
    options: [
      "A. L'apex cardiaque est orient√© en haut, √† droite et en arri√®re",
      "B. La face ant√©rieure (sterno-costale) est form√©e principalement par le ventricule droit",
      "C. Le bord droit du c≈ìur est form√© par le ventricule droit",
      "D. La face diaphragmatique est essentiellement constitu√©e de l'oreillette gauche"
    ],
    correct: 1,
    explanation: "Correct ! Ton c≈ìur bat parfaitement üíó",
    wrong: "Oups‚Ä¶ m√™me les meilleurs cardiologues se trompent parfois ü§ç"
  },
  {
    text: "√Ä propos du sillon coronaire (sulcus atrioventricularis), quelle description anatomique est exacte ?",
    options: [
      "A. Il s√©pare les deux ventricules entre eux",
      "B. Il correspond √† la projection du sillon interventriculaire ant√©rieur",
      "C. Il d√©limite la limite entre les oreillettes et les ventricules, faisant le tour du c≈ìur",
      "D. Il contient exclusivement l'art√®re interventriculaire ant√©rieure"
    ],
    correct: 2,
    explanation: "Parfait ! Tu connais vraiment bien l'anatomie cardiaque üíó",
    wrong: "Oups‚Ä¶ m√™me les meilleurs cardiologues se trompent parfois ü§ç"
  },
  {
    text: "Concernant la valve mitrale (valvule mitrale bicuspide), quelle affirmation est correcte ?",
    options: [
      "A. Elle est constitu√©e de trois valvules semilunaires",
      "B. Elle est situ√©e entre l'oreillette droite et le ventricule droit",
      "C. Ses deux cuspides (grande et petite) sont reli√©es aux muscles papillaires via les cordages tendineux",
      "D. Elle s'ouvre lors de la systole ventriculaire gauche pour laisser passer le sang"
    ],
    correct: 2,
    explanation: "Excellent ! Tes connaissances valvulaires sont impeccables üíó",
    wrong: "Oups‚Ä¶ m√™me les meilleurs cardiologues se trompent parfois ü§ç"
  },
  {
    text: "Concernant la cloison interauriculaire, quelle affirmation est anatomiquement correcte ?",
    options: [
      "A. Elle est constitu√©e par le septum interventriculaire musculaire",
      "B. Elle pr√©sente chez l'adulte une d√©pression appel√©e fossa ovalis, vestige du foramen ovale f≈ìtal",
      "C. Elle est totalement imperm√©able d√®s la naissance, sans vestige f≈ìtal",
      "D. Elle s√©pare l'oreillette gauche du ventricule droit"
    ],
    correct: 1,
    explanation: "Brillant(e) ! La fossa ovalis n'a plus de secrets pour toi üíó",
    wrong: "Oups‚Ä¶ m√™me les meilleurs cardiologues se trompent parfois ü§ç"
  }
];

/* ============================================================
   √âTAT DU JEU
   ============================================================ */
let currentQ    = 0;
let piecesWon   = 0;
let answered    = false;
let musicStarted = false;

const pieceIcons = ['üíï','üíñ','üíó','üíù'];

/* ============================================================
   INIT
   ============================================================ */
window.addEventListener('DOMContentLoaded', () => {
  initFloatingHearts();
  renderQuestion(currentQ);
  // üéµ Lancer automatiquement la musique de fond au chargement
const bgMusic = document.getElementById('bgMusic');
bgMusic.volume = 0.3;
bgMusic.play().catch(() => {
  // Si l'autoplay est bloqu√© par le navigateur, lancer au premier clic
  document.body.addEventListener('click', () => {
    bgMusic.play().catch(()=>{});
  }, { once: true });
});

});

/* ============================================================
   C≈íURS FLOTTANTS EN ARRI√àRE-PLAN
   ============================================================ */
function initFloatingHearts() {
  const container = document.getElementById('floatingHearts');
  const emojis = ['üíó','ü©∑','‚ù§Ô∏è','üíï','üå∏','‚ú®'];
  for (let i = 0; i < 14; i++) {
    const h = document.createElement('span');
    h.className = 'fheart';
    h.textContent = emojis[Math.floor(Math.random() * emojis.length)];
    h.style.left = Math.random() * 100 + 'vw';
    h.style.animationDuration = (8 + Math.random() * 12) + 's';
    h.style.animationDelay    = (Math.random() * 10) + 's';
    h.style.fontSize          = (.6 + Math.random() * 1) + 'rem';
    container.appendChild(h);
  }
}

/* ============================================================
   AFFICHAGE D'UNE QUESTION
   ============================================================ */
function renderQuestion(index) {
  const q = questions[index];
  document.getElementById('questionBadge').textContent = `Question ${index + 1} / 4`;
  document.getElementById('questionText').textContent  = q.text;

  // Dots
  for (let i = 0; i < 4; i++) {
    const dot = document.getElementById('dot-' + i);
    dot.className = 'dot' + (i < index ? ' done' : i === index ? ' active' : '');
  }

  // Options
  const container = document.getElementById('optionsContainer');
  container.innerHTML = '';
  const letters = ['A', 'B', 'C', 'D'];
  q.options.forEach((opt, i) => {
    const btn = document.createElement('button');
    btn.className  = 'option-btn';
    btn.innerHTML  = `<span class="option-letter">${letters[i]}</span><span>${opt.substring(3)}</span>`;
    btn.onclick    = () => selectAnswer(i);
    container.appendChild(btn);
  });

  // Reset feedback
  const fb = document.getElementById('feedback');
  fb.style.display = 'none';
  document.getElementById('btnNext').style.display = 'none';
  answered = false;

  // R√©-animation de la carte
  const card = document.getElementById('quizCard');
  card.style.animation = 'none';
  void card.offsetWidth;
  card.style.animation = 'cardIn .5s cubic-bezier(.34,1.56,.64,1) both';
}

/* ============================================================
   S√âLECTION D'UNE R√âPONSE
   ============================================================ */
function selectAnswer(index) {
  // if (answered) return;
  // answered = true;
  // üéµ D√©marrer la musique de fond au premier clic



  const q       = questions[currentQ];
  const buttons = document.querySelectorAll('.option-btn');
  buttons.forEach(b => b.disabled = true);

  const fb      = document.getElementById('feedback');
  const sticker = document.getElementById('feedbackSticker');
  const msg     = document.getElementById('feedbackMsg');

  if (index === q.correct) {
    // ‚úÖ BONNE R√âPONSE
    buttons[index].classList.add('correct');
    fb.className = 'feedback good';
    fb.style.display = 'flex';
    sticker.textContent = ['üéâ','‚ú®','üíñ','üå∏'][currentQ];
    msg.textContent     = q.explanation;
    triggerHeartRain();
    playPieceSound();
    setTimeout(() => addPiece(), 400);
  } else {
    // ‚ùå MAUVAISE R√âPONSE
    buttons[index].classList.add('wrong');
    buttons[q.correct].classList.add('correct');
    fb.className = 'feedback bad';
    fb.style.display = 'flex';
    sticker.textContent = 'üå∏';
    msg.textContent     = q.wrong;
  }

  // Bouton Suivant
  const btnNext = document.getElementById('btnNext');
  btnNext.style.display = 'block';
  if (currentQ === 3) {
    btnNext.textContent = index === q.correct ? 'Voir ma surprise üéÅ' : 'Continuer üíó';
  }
}

/* ============================================================
   AJOUT D'UNE PI√àCE AU PUZZLE
   ============================================================ */
function addPiece() {
  const piece = document.getElementById('piece-' + piecesWon);
  piece.innerHTML = `<span class="piece-icon">${pieceIcons[piecesWon]}</span>`;
  piece.classList.add('filled');

  piecesWon++;
  const pct = (piecesWon / 4) * 100;
  document.getElementById('progressBar').style.width  = pct + '%';
  document.getElementById('progressText').textContent = `${piecesWon} / 4 pi√®ces collect√©es`;

  // Flash lumineux doux
  const flash = document.getElementById('flashOverlay');
  flash.style.display = 'block';
  setTimeout(() => { flash.style.display = 'none'; }, 400);
}

/* ============================================================
   QUESTION SUIVANTE
   ============================================================ */
function nextQuestion() {
  currentQ++;
  if (currentQ < 4) {
    renderQuestion(currentQ);
  } else {
    showComplete();
  }
}

/* ============================================================
   √âCRAN PUZZLE COMPLET
   ============================================================ */
function showComplete() {
  // üõë Stop musique de fond
const bgMusic = document.getElementById('bgMusic');
bgMusic.pause();
bgMusic.currentTime = 0;

  document.getElementById('screen-quiz').style.display    = 'none';
  document.getElementById('progressDots').style.display   = 'none';

  // Effet lumineux final
  const glow = document.getElementById('finalGlow');
  glow.style.display = 'block';
  setTimeout(() => { glow.style.display = 'none'; }, 2500);

  // Pluie intense
  triggerBigHeartRain();

  const sc = document.getElementById('screen-complete');
  sc.style.display = 'block';
  sc.style.animation = 'none';
  void sc.offsetWidth;
  sc.style.animation = 'cardIn .6s cubic-bezier(.34,1.56,.64,1) both';
}

/* ============================================================
   AFFICHER L'ENVELOPPE
   ============================================================ */
function showEnvelope() {
  document.getElementById('screen-complete').style.display  = 'none';
  const se = document.getElementById('screen-envelope');
  se.style.display = 'block';
  // Scroll doux vers le haut
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

/* ============================================================
   OUVRIR L'ENVELOPPE
   ============================================================ */
function openEnvelope() {
  const env   = document.getElementById('envelope');
  const flap  = document.getElementById('envFlap');
  const heart = document.getElementById('envHeart');

  // Arr√™te l'animation de tremblement
  env.style.animation = 'none';
  env.onclick = null; // √©vite double clic

  // Animation d'ouverture
  env.classList.add('opening');
  heart.style.animation = 'none';
  heart.style.opacity   = '0';

  setTimeout(() => {
    document.getElementById('screen-envelope').style.display = 'none';
    const sm = document.getElementById('screen-message');
    sm.style.display = 'block';

    // Lance l'audio
    playAudio();

    // Pluie de c≈ìurs
    triggerHeartRain();

    // Scroll
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }, 900);
}

/* ============================================================
   AUDIO
   ============================================================ */
function playAudio() {
  const audio = document.getElementById('audioMessage');
  audio.currentTime = 0;
  audio.play().catch(() => {
    // Navigateur bloque l'autoplay ‚Üí affich√© quand m√™me
    console.log('Autoplay bloqu√©, cliquez sur Rejouer');
  });
}

/* ============================================================
   SONS (via Web Audio API ‚Äî son mignon g√©n√©r√© en JS)
   ============================================================ */
let audioCtx = null;
function getAudioCtx() {
  if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  return audioCtx;
}

function playPieceSound() {
  try {
    const ctx  = getAudioCtx();
    const notes = [523, 659, 784, 1047]; // Do Mi Sol Do
    notes.forEach((freq, i) => {
      const osc  = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.connect(gain);
      gain.connect(ctx.destination);
      osc.type = 'sine';
      osc.frequency.setValueAtTime(freq, ctx.currentTime + i * 0.1);
      gain.gain.setValueAtTime(0, ctx.currentTime + i * 0.1);
      gain.gain.linearRampToValueAtTime(.18, ctx.currentTime + i * 0.1 + 0.04);
      gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + i * 0.1 + 0.3);
      osc.start(ctx.currentTime + i * 0.1);
      osc.stop(ctx.currentTime + i * 0.1 + 0.3);
    });
  } catch(e) {}
}

/* ============================================================
   PLUIE DE C≈íURS
   ============================================================ */
function triggerHeartRain() {
  const container = document.getElementById('heartRain');
  const emojis    = ['üíó','üíï','ü©∑','‚ù§Ô∏è','‚ú®','üå∏'];
  for (let i = 0; i < 18; i++) {
    setTimeout(() => {
      const h = document.createElement('span');
      h.className  = 'rain-heart';
      h.textContent = emojis[Math.floor(Math.random() * emojis.length)];
      h.style.left  = Math.random() * 100 + 'vw';
      h.style.animationDuration = (.7 + Math.random() * .7) + 's';
      h.style.animationDelay    = '0s';
      h.style.fontSize = (.9 + Math.random() * .8) + 'rem';
      container.appendChild(h);
      setTimeout(() => h.remove(), 1400);
    }, i * 60);
  }
}

function triggerBigHeartRain() {
  for (let r = 0; r < 4; r++) {
    setTimeout(() => triggerHeartRain(), r * 300);
  }
}
// window.addEventListener('DOMContentLoaded', () => {
//   initFloatingHearts();
//   renderQuestion(currentQ);

//   // üéµ Essayer de jouer la musique au chargement
//   const bgMusic = document.getElementById('bgMusic');
//   bgMusic.volume = 0.4;
//   bgMusic.play().catch(() => {
//     // Si l'autoplay est bloqu√©, attendre le premier clic pour d√©marrer
//     document.body.addEventListener('click', () => {
//       bgMusic.play().catch(()=>{});
//     }, { once: true });
//   });
// });

</script>
</body>

</html>

